<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir=".." default="build" name="chameleon" xmlns:ivy="antlib:org.apache.ivy.ant">

  <property file="properties"/>
  <!-- Override in the properties file if these are not appropriate
       for your directory layout -->
  <property name="workspace.dir" value="${basedir}/.."/>
  <property name="common.dir" value="${workspace.dir}/common"/>
  <property name="base_library" value="base_library"/>
  <import file="${common.dir}/build/build.xml"/>

  <property name="dist.base_library" value="${dist}/base_library"/>
  <property name="dist.compiled_base_library" value="${dist}/compiled_base_library"/>

  <target name="build-base" depends="compile">
    <path id="jloc.path">
      <pathelement path="${bin}"/>
      <path refid="project.classpath"/>
    </path>
    <taskdef name="jloc" classname="jlo.ant.AntCompileTask" classpathref="jloc.path"/>
    <mkdir dir="${dist.base_library}"/>
    <mkdir dir="${dist.compiled_base_library}"/>
    <jloc config="${base_library}/project.xml" destdir="${dist.base_library}"/>
    <javac srcdir="${dist.base_library}" destdir="${dist.compiled_base_library}"/>
    <jar jarfile="${dist}/jlo-base.jar">
      <fileset dir="${dist.compiled_base_library}"/>
      <fileset dir="${dist.base_library}"/>
      <fileset dir="${base_library}/src"/>
    </jar>
  </target>

  <target name="jar" depends="build-base">
    <jar jarfile="${dist.jar}/${module}.jar">
      <fileset dir="${bin}"/>
      <fileset dir="${base_library}/src" includes="**/*.jlo"/>
      <fileset dir="${dist.compiled_base_library}"/>
      <fileset dir="${dist.base_library}"/>
    </jar>
  </target>

</project>
